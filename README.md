# USPEX_proteins

Предсказание третичной структуры белка на основе первичной аминокислотной последовательности с помощью генетического алгоритма USPEX.

Поддерживает все потенциалы, указанные в папке forcefields. Рекомендуемые потенциалы - amber99sb.prm, charmm22cmap.prm

Содержимое:
 - FunctionFolder - рабочий код USPEX для расчётов
 - Specific - информация о том белке, который мы оптимизируем в текущий момент, и условия оптимизации
 - Submission - код для отправления процесса оптимизации белков на кластер
 - forcefields - набор потенциалов
 - INPUT.txt - конфигурация расчётов USPEX
 - USPEX.m - стартовая точка расчёта, которая запускает единичный шаг оптимизации
 - sbatch_script - скрипт для отправки множественного запуска USPEX.m на кластер

Для детальной информации по содержанию INPUT.txt изучите [соответствующие главы мануала USPEX](https://uspex-team.org/online_utilities/uspex_manual_release/EnglishVersion/uspex_manual_english/inputs.html)
## Запуск
Единичный ручной запуск:

`matlab < USPEX.m`

Полный запуск расчёта белка на все поколения:
`sbatch sbatch_script` (рекомендуемый способ) - отправит sbatch_script на одну из нод, с которой будут идти отдельные запуски USPEX.m\
`nohup ./sbatch_script &` - если вы хотите, чтобы sbatch_script крутился локально (расчёты отдельных минимизаций всё ещё будут идти удаленно, если это указано в поле whichCluster файла INPUT.txt)

Очистка рабочей директории после завершения расчётов:\
`USPEX --clean`\
Удалит все промежуточные рабочие файлы, связанные с расчётом (в первую очередь CalcFold). Оставляет файлы указанные выше + директорую с результатами расчёта.


## Важно
Перед началом работы необходимо указать путь к директории со структурами реальных белков (DB):
1. Расположите директорию в удобной для вас месте.
2. В файле FunctionFolder/USPEX/M400/Random_Init_M400.m на 32 строке `folder=['<INSERT YOUR ABSOLUTE PATH TO DB>/' num2str(which_res) '_res'];`, укажите вместо заглушки путь до вашей директории.
3. Результат может выглядеть так: `folder=['/home/prachitskiy/DB/' num2str(which_res) '_res'];`
4. Вы великолепны и готовы запускаться.
